generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "mysql"
  url      = "mysql://root:@localhost:3306/pi_driveparts"
}

model pro_produto {
  pro_id               Int       @id @default(autoincrement())
  pro_nome             String    @db.VarChar(45)
  pro_valor            Int
  pro_cod              String    @db.VarChar(45)
  pro_marca            String    @db.VarChar(45)
  pro_status           Boolean   @default(true) @db.TinyInt
  pro_data_criacao     DateTime  @default(now())
  pro_data_modificacao DateTime  @default(now())
  pro_data_exclusao    DateTime?

  mov_movimentacao_estoque mov_movimentacao_estoque[]
  ite_itemVenda            ite_itemVenda[]
  pro_esp                  pro_esp[]

  @@map("pro_produto")
}

model mov_movimentacao_estoque {
  mov_id   Int      @id @default(autoincrement())
  mov_data DateTime
  mov_qtd  Int
  mov_tipo MovTipo
  pro_id   Int
  ven_id   Int?

  pro_produto pro_produto @relation(fields: [pro_id], references: [pro_id])
  ven_venda   ven_venda?  @relation(fields: [ven_id], references: [ven_id])

  @@map("est_estoque")
}

model ite_itemVenda {
  ite_id    Int   @id @default(autoincrement())
  ite_qtd   Int
  ite_valor Float
  pro_id    Int
  ven_id    Int

  pro_produto pro_produto @relation(fields: [pro_id], references: [pro_id])
  ven_venda   ven_venda   @relation(fields: [ven_id], references: [ven_id])

  @@map("ite_itemVenda")
}

model usu_usuario {
  usu_id               Int         @id @default(autoincrement())
  usu_nome             String      @db.VarChar(45)
  usu_tel              String      @unique @db.VarChar(45)
  usu_senha            String      @db.VarChar(255)
  usu_status           Boolean     @db.TinyInt
  usu_data_criacao     DateTime    @default(now())
  usu_data_modificacao DateTime    @default(now())
  usu_data_exclusao    DateTime?
  ven_venda            ven_venda[]

  @@map("usu_usuario")
}

model ven_venda {
  ven_id               Int        @id @default(autoincrement())
  ven_data_criacao     DateTime   @default(now())
  ven_data_modificacao DateTime   @default(now())
  ven_valor            Float
  ven_status           VenStatus
  ven_periodo          VenPeriodo
  ven_pagamento        String     @db.VarChar(45)
  usu_id               Int

  ite_itemVenda           ite_itemVenda[]
  usu_usuario             usu_usuario                @relation(fields: [usu_id], references: [usu_id])
  movMovimentacaoEstoques mov_movimentacao_estoque[]

  @@map("ven_venda")
}

model cat_categoria {
  cat_id            Int                 @id @default(autoincrement())
  cat_nome          String              @db.VarChar(45)
  esp_especificacao esp_especificacao[]

  @@map("cat_categoria")
}

model esp_especificacao {
  esp_id   Int    @id @default(autoincrement())
  esp_nome String @db.VarChar(45)
  cat_id   Int

  cat_categoria cat_categoria @relation(fields: [cat_id], references: [cat_id])
  pro_esp       pro_esp[]

  @@map("esp_especificacao")
}

model met_metrica {
  met_id   Int       @id @default(autoincrement())
  met_nome String    @db.VarChar(45)
  pro_esp  pro_esp[]

  @@map("met_metrica")
}

model pro_esp {
  pro_id        Int
  esp_id        Int
  pro_esp_valor String @db.VarChar(45)
  met_id        Int

  pro_produto       pro_produto       @relation(fields: [pro_id], references: [pro_id])
  esp_especificacao esp_especificacao @relation(fields: [esp_id], references: [esp_id])
  met_metrica       met_metrica       @relation(fields: [met_id], references: [met_id])

  @@id([pro_id, esp_id])
  @@map("pro_esp")
}

enum VenStatus {
  CONCLUIDA
  RESERVA
  CANCELADA
  EXPIRADA
}

enum VenPeriodo {
  MANHA
  TARDE
}

enum MovTipo {
  COMPRA
  VENDA
}
